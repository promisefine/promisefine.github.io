{"meta":{"title":"Doney","subtitle":"å·é‡ã®åšå®¢","description":"ä¸“ç§‘ | è®¡ç®—æœºç§‘å­¦ä¸æŠ€æœ¯ | ç½‘ç»œå®‰å…¨","author":"Doney","url":"https://promisefine.github.io","root":"/"},"pages":[{"title":"","date":"2021-07-12T00:45:59.560Z","updated":"2021-07-12T00:45:59.560Z","comments":true,"path":"baidu_verify_xxxxxxx.html","permalink":"https://promisefine.github.io/baidu_verify_xxxxxxx.html","excerpt":"","text":"wvlc3L96QK"},{"title":"404","date":"2019-08-10T08:41:10.000Z","updated":"2021-07-12T00:45:59.354Z","comments":true,"path":"404.html","permalink":"https://promisefine.github.io/404.html","excerpt":"","text":""},{"title":"","date":"2021-07-12T00:45:59.563Z","updated":"2021-07-12T00:45:59.563Z","comments":true,"path":"google1xxxxxxx0.html","permalink":"https://promisefine.github.io/google1xxxxxxx0.html","excerpt":"","text":"google-site-verification: google110e5e5e14c8dcf0.html"},{"title":"about","date":"2019-10-24T16:00:00.000Z","updated":"2021-07-12T00:45:59.558Z","comments":true,"path":"about/index.html","permalink":"https://promisefine.github.io/about/index.html","excerpt":"","text":""},{"title":"æ”¾æ¾ä¸€ä¸‹","date":"2019-08-10T08:41:10.000Z","updated":"2021-07-12T00:45:59.389Z","comments":true,"path":"List/index.html","permalink":"https://promisefine.github.io/List/index.html","excerpt":"","text":"å½±éŸ³èµ„æºå…±äº«"},{"title":"archives","date":"2019-10-24T16:00:00.000Z","updated":"2021-07-12T00:45:59.559Z","comments":true,"path":"archives/index.html","permalink":"https://promisefine.github.io/archives/index.html","excerpt":"","text":""},{"title":"ç»Ÿè®¡","date":"2020-10-31T02:11:28.000Z","updated":"2021-07-12T00:45:59.561Z","comments":true,"path":"census/index.html","permalink":"https://promisefine.github.io/census/index.html","excerpt":"","text":""},{"title":"categories","date":"2019-10-24T16:00:00.000Z","updated":"2021-07-12T00:45:59.560Z","comments":true,"path":"categories/index.html","permalink":"https://promisefine.github.io/categories/index.html","excerpt":"","text":""},{"title":"ç•™è¨€æ¿","date":"2019-10-24T16:00:00.000Z","updated":"2021-07-14T06:09:43.269Z","comments":true,"path":"contact/index.html","permalink":"https://promisefine.github.io/contact/index.html","excerpt":"","text":"ç•…æ‰€æ¬²è¨€ åœ¨è¿™é‡Œå¯ä»¥ç•™ä¸‹ä½ çš„è¶³è¿¹ï¼Œæ¬¢è¿åœ¨ä¸‹æ–¹ç•™è¨€ï¼Œæ¬¢è¿äº¤æ¢å‹é“¾ï¼Œä¸€èµ·äº¤æµå­¦ä¹ ï¼"},{"title":"èµ„æºåˆ†äº«","date":"2019-07-19T08:40:27.000Z","updated":"2021-07-12T00:45:59.564Z","comments":true,"path":"resource/index.html","permalink":"https://promisefine.github.io/resource/index.html","excerpt":"","text":""},{"title":"tags","date":"2019-07-19T08:40:27.000Z","updated":"2021-07-12T00:45:59.566Z","comments":true,"path":"tags/index.html","permalink":"https://promisefine.github.io/tags/index.html","excerpt":"","text":""},{"title":"ç›¸å†Œ","date":"2021-07-12T00:45:59.362Z","updated":"2021-07-12T00:45:59.362Z","comments":true,"path":"List/galleries/index.html","permalink":"https://promisefine.github.io/List/galleries/index.html","excerpt":"","text":""},{"title":"è§†é¢‘","date":"2019-08-10T08:41:10.000Z","updated":"2021-07-12T00:45:59.390Z","comments":true,"path":"List/movies/index.html","permalink":"https://promisefine.github.io/List/movies/index.html","excerpt":"","text":""},{"title":"å¬å¬éŸ³ä¹","date":"2019-07-19T08:40:27.000Z","updated":"2021-07-12T00:45:59.391Z","comments":true,"path":"List/music/index.html","permalink":"https://promisefine.github.io/List/music/index.html","excerpt":"","text":""},{"title":"ä¹–å·§å°ç‹—","date":"2021-07-12T00:45:59.362Z","updated":"2021-07-12T00:45:59.362Z","comments":true,"path":"List/galleries/ä¹–å·§å°ç‹—/index.html","permalink":"https://promisefine.github.io/List/galleries/%E4%B9%96%E5%B7%A7%E5%B0%8F%E7%8B%97/index.html","excerpt":"","text":""},{"title":"å¬å¬éŸ³ä¹","date":"2019-07-19T08:40:27.000Z","updated":"2021-07-12T00:45:59.392Z","comments":true,"path":"List/tools/index.html","permalink":"https://promisefine.github.io/List/tools/index.html","excerpt":"","text":""},{"title":"äºŒæ¬¡å…ƒé£","date":"2021-07-12T00:45:59.362Z","updated":"2021-07-12T00:45:59.362Z","comments":true,"path":"List/galleries/äºŒæ¬¡å…ƒé£/index.html","permalink":"https://promisefine.github.io/List/galleries/%E4%BA%8C%E6%AC%A1%E5%85%83%E9%A3%8E/index.html","excerpt":"","text":""},{"title":"åŠ¨æ¼«äººç‰©","date":"2021-07-12T00:45:59.372Z","updated":"2021-07-12T00:45:59.372Z","comments":true,"path":"List/galleries/åŠ¨æ¼«äººç‰©/index.html","permalink":"https://promisefine.github.io/List/galleries/%E5%8A%A8%E6%BC%AB%E4%BA%BA%E7%89%A9/index.html","excerpt":"","text":""},{"title":"åŠ¨æ¼«æ’ç”»","date":"2021-07-12T00:45:59.372Z","updated":"2021-07-12T00:45:59.372Z","comments":true,"path":"List/galleries/åŠ¨æ¼«æ’ç”»/index.html","permalink":"https://promisefine.github.io/List/galleries/%E5%8A%A8%E6%BC%AB%E6%8F%92%E7%94%BB/index.html","excerpt":"","text":""},{"title":"åŠ¨æ¼«é£æ™¯","date":"2021-07-12T00:45:59.372Z","updated":"2021-07-12T00:45:59.372Z","comments":true,"path":"List/galleries/åŠ¨æ¼«é£æ™¯/index.html","permalink":"https://promisefine.github.io/List/galleries/%E5%8A%A8%E6%BC%AB%E9%A3%8E%E6%99%AF/index.html","excerpt":"","text":""},{"title":"å‘†èŒçŒ«å’ª","date":"2021-07-12T00:45:59.372Z","updated":"2021-07-12T00:45:59.372Z","comments":true,"path":"List/galleries/å‘†èŒçŒ«å’ª/index.html","permalink":"https://promisefine.github.io/List/galleries/%E5%91%86%E8%90%8C%E7%8C%AB%E5%92%AA/index.html","excerpt":"","text":""},{"title":"åŸå¸‚é£å…‰","date":"2021-07-12T00:45:59.379Z","updated":"2021-07-12T00:45:59.379Z","comments":true,"path":"List/galleries/åŸå¸‚é£å…‰/index.html","permalink":"https://promisefine.github.io/List/galleries/%E5%9F%8E%E5%B8%82%E9%A3%8E%E5%85%89/index.html","excerpt":"","text":""},{"title":"æ¸…æ–°èŠ±å‰","date":"2021-07-12T00:45:59.380Z","updated":"2021-07-12T00:45:59.380Z","comments":true,"path":"List/galleries/æ¸…æ–°èŠ±å‰/index.html","permalink":"https://promisefine.github.io/List/galleries/%E6%B8%85%E6%96%B0%E8%8A%B1%E5%8D%89/index.html","excerpt":"","text":""},{"title":"ç‚«é…·è·‘è½¦","date":"2021-07-12T00:45:59.382Z","updated":"2021-07-12T00:45:59.382Z","comments":true,"path":"List/galleries/ç‚«é…·è·‘è½¦/index.html","permalink":"https://promisefine.github.io/List/galleries/%E7%82%AB%E9%85%B7%E8%B7%91%E8%BD%A6/index.html","excerpt":"","text":""},{"title":"ç’€ç’¨æ˜Ÿç©º","date":"2021-07-12T00:45:59.384Z","updated":"2021-07-12T00:45:59.384Z","comments":true,"path":"List/galleries/ç’€ç’¨æ˜Ÿç©º/index.html","permalink":"https://promisefine.github.io/List/galleries/%E7%92%80%E7%92%A8%E6%98%9F%E7%A9%BA/index.html","excerpt":"","text":""},{"title":"ç”œç¾é£Ÿå“","date":"2021-07-12T00:45:59.386Z","updated":"2021-07-12T00:45:59.386Z","comments":true,"path":"List/galleries/ç”œç¾é£Ÿå“/index.html","permalink":"https://promisefine.github.io/List/galleries/%E7%94%9C%E7%BE%8E%E9%A3%9F%E5%93%81/index.html","excerpt":"","text":""},{"title":"è‡ªç„¶é£æ™¯","date":"2021-07-12T00:45:59.387Z","updated":"2021-07-12T00:45:59.387Z","comments":true,"path":"List/galleries/è‡ªç„¶é£æ™¯/index.html","permalink":"https://promisefine.github.io/List/galleries/%E8%87%AA%E7%84%B6%E9%A3%8E%E6%99%AF/index.html","excerpt":"","text":""}],"posts":[{"title":"ç®—æ³•","slug":"algorithm","date":"2019-11-29T02:01:45.000Z","updated":"2021-07-15T11:48:33.858Z","comments":true,"path":"posts/9505ccb9.html","link":"","permalink":"https://promisefine.github.io/posts/9505ccb9.html","excerpt":"","text":"å¤æ‚åº¦// å¤§Oç®—æ³•å°±æ˜¯ç®—æ³•æ‰§â¾æ‰€éœ€è¦çš„æ‰§â¾æ¬¡æ•°ï¼Œå’Œæ•°æ®é‡çš„å…³ç³»(æ—¶é—´å¤æ‚åº¦),å â½¤é¢å¤–ç©ºé—´å’Œæ•°æ®é‡çš„å…³ç³»(ç©ºé—´å¤æ‚åº¦) O(1) : å¸¸æ•°å¤æ‚åº¦ (å’Œæ•°æ®é‡â½†å…³) O(logn) :å¯¹æ•°å¤æ‚åº¦ (â¼†åˆ†) O(n) : çº¿æ€§æ—¶é—´å¤æ‚åº¦ ï¼ˆæ•°ç»„éå†â¼€æ¬¡ï¼‰ O(n*logn) : çº¿æ€§å¯¹æ•° ï¼ˆéå†+â¼†åˆ†ï¼‰ O(n^2) : å¹³â½… ä¸¤å±‚éå† O(2^n) : æŒ‡æ•° é€’å½’ O(n!) : é˜¶ä¹˜ å†’æ³¡æ’åºfunction bubleSort(arr) { var len = arr.length for (let outer = len; outer &gt;= 2; outer--) { for (let inner = 0; inner &lt;= outer - 1; inner++) { if (arr[inner] &gt; arr[inner + 1]) { [arr[inner], arr[inner + 1]] = [arr[inner + 1], arr[inner]] } } } return arr } console.log(bubleSort([4, 3, 6, 1, 9, 6, 2])) æ’å…¥æ’åºfunction insertSort(arr) { for (let i = 1; i &lt; arr.length; i++) { //å¤–å¾ªç¯ä»1å¼€å§‹ï¼Œé»˜è®¤arr[0]æ˜¯æœ‰åºæ®µ for (let j = i; j &gt; 0; j--) { //j = i,å°†arr[j]ä¾æ¬¡æ’â¼Šæœ‰åºæ®µä¸­ if (arr[j] &lt; arr[j - 1]) { [arr[j], arr[j - 1]] = [arr[j - 1], arr[j]]; } else { break; } } } return arr; } console.log(insertSort([11, 4, 3, 6, 1, 9, 7, 2, 0])) å¿«é€Ÿæ’åºfunction quickSort(arr) { if (arr.length &lt;= 1) { return arr; //é€’å½’å‡ºâ¼ } var left = [], right = [], current = arr.splice(0, 1); //æ³¨æ„spliceåï¼Œæ•°ç»„â»“åº¦å°‘äº†â¼€ä¸ª for (let i = 0; i &lt; arr.length; i++) { if (arr[i] &lt; current) { left.push(arr[i]) //æ”¾åœ¨å·¦è¾¹ } else { right.push(arr[i]) //æ”¾åœ¨å³è¾¹ } } return quickSort(left).concat(current, quickSort(right)); //é€’å½’ } æ•°ç»„æ‰å¹³åŒ–Array.prototype.flat = function () { var arr = []; this.forEach((item, idx) =&gt; { if (Array.isArray(item)) { arr = arr.concat(item.flat()); //é€’å½’å»å¤„ç†æ•°ç»„å…ƒç´  } else { arr.push(item) //â¾®æ•°ç»„ç›´æ¥pushè¿›å» } }) return arr; //é€’å½’å‡ºâ¼ } arr = [1, 2, 3, [4, 5, [6, 7, [8, 9]]], [10, 11] ] console.log(arr.flat()) æŸ¥æ‰¾ç®—æ³•// å¾ªç¯çš„äºŒåˆ†æŸ¥æ‰¾ function binarySearch(arr, target) { var low = 0, high = arr.length - 1, mid; while (low &lt;= high) { mid = Math.floor((low + high) / 2); if (target === arr[mid]) { return `æ‰¾åˆ°äº†${target},åœ¨ç¬¬${mid + 1}ä¸ª` } if (target &gt; arr[mid]) { low = mid + 1; } else if (target &lt; arr[mid]) { high = mid - 1; } } return -1 } console.log(binarySearch([1, 2, 3, 4, 5, 7, 9, 11, 14, 16, 17, 22, 33, 55, 65], 4)) // é€’å½’çš„äºŒåˆ†æŸ¥æ‰¾ function binarySearch1(arr, target, low = 0, high = arr.length - 1) { const n = Math.floor((low + high) / 2); const cur = arr[n]; if (cur === target) { return `æ‰¾åˆ°äº†${target},åœ¨ç¬¬${n+1}ä¸ª`; } else if (cur &gt; target) { return binarySearch1(arr, target, low, n - 1); } else if (cur &lt; target) { return binarySearch1(arr, target, n + 1, high); } return -1; } æ•°æ®ç»“æ„æ ˆclass Stack { constructor() { this.items = [] } push(item) { this.items.push(item) } pop() { return this.items.pop() } size() { return this.items.length } clear() { this.items = [] } } ç´¢å¼•: O(n) æœç´¢: O(n) æ’â¼Š: O(1) ç§»é™¤: O(1) // ç»å…¸æ¡ˆä¾‹ï¼š æ‹¬å·åŒ¹é…ï¼Œhtmlæ ‡ç­¾åŒ¹é…ï¼Œè¿›åˆ¶è½¬æ¢ function isBalance(symbol) { const stack = new Stack() const left = '{(' const right = '})' let popValue let tag = true const match = function (popValue, current) { if (left.indexOf(popValue) !== right.indexOf(current)) { tag = false } } for (let i = 0; i &lt; symbol.length; i++) { if (left.includes(symbol[i])) { stack.push(symbol[i]) } else if (right.includes(symbol[i])) { popValue = stack.pop() match(popValue, symbol[i]) } } return tag } console.log(isBalance('{{(({}))}}')) console.log(isBalance('{{(({})}}')) é“¾è¡¨ class Node { constructor(element) { this.element = element this.next = null } } class LinkedList { constructor() { this.head = null this.current this.length = 0 } append(element) { const node = new Node(element) if (this.head === null) { // æ’â¼Šç¬¬â¼€ä¸ªé“¾è¡¨ this.head = node } else { this.current = this.head while (this.current.next) { // æ‰¾åˆ°æœ€åâ¼€ä¸ªèŠ‚ç‚¹ this.current = this.current.next } this.current.next = node } this.length++ } // ç§»é™¤æŒ‡å®šä½ç½®å…ƒç´  removeAt(position) { if (position &gt; -1 &amp;&amp; position &lt; this.length) { let previous let index = 0 if (position === 0) { // å¦‚æœæ˜¯ç¬¬â¼€ä¸ªé“¾è¡¨çš„è¯, ç‰¹æ®Šå¯¹å¾… this.head = this.head.next } else { å¼€è¯¾å§webå…¨æ ˆæ¶æ„å¸ˆ this.current = this.head while (index &lt; position) { // å¾ªç¯æ‰¾åˆ°å½“å‰è¦åˆ é™¤å…ƒç´ çš„ä½ç½® previous = this.current this.current = this.current.next index++ } previous.next = this.current.next } this.length-- } } // åœ¨æŒ‡å®šä½ç½®åŠ â¼Šå…ƒç´  insert(position, element) { const node = new Node(element) let index = 0 let current, previous if (position &gt; -1 &amp;&amp; position &lt; this.length + 1) { if (position === 0) { // åœ¨é“¾è¡¨æœ€å‰æ’â¼Šå…ƒç´  current = this.head this.head = node this.head.next = current } else { current = this.head while (index &lt; position) { // åŒ removeAt é€»è¾‘, æ‰¾åˆ°â½¬æ ‡ä½ç½® previous = current current = current.next index++ } previous.next = node // åœ¨â½¬æ ‡ä½ç½®æ’â¼Šç›¸åº”å…ƒç´  node.next = current } this.length++ } } // é“¾è¡¨ä¸­æ˜¯å¦å«æœ‰æŸä¸ªå…ƒç´ , å¦‚æœæœ‰çš„è¯è¿”å›ç›¸åº”ä½ç½®, â½†çš„è¯è¿”å› -1 indexOf(element) { let index = 0 this.current = this.head while (index &lt; this.length) { if (this.current.element === element) { return index } this.current = this.current.next index++ } return -1 } // ç§»é™¤æŸå…ƒç´  remove(element) { const position = this.indexOf(element) this.removeAt(position) } // è·å–â¼¤â¼© size() { return this.length } // è·å–æœ€å¼€å¤´çš„é“¾è¡¨ getHead() { return this.head } // æ˜¯å¦ä¸ºç©º isEmpty() { return this.length === 0 } // æ‰“å°é“¾è¡¨å…ƒç´  log() { this.current = this.head let str = this.current.element while (this.current.next) { this.current = this.current.next str = str + ' ' + this.current.element } console.log(str) return str } } // æµ‹è¯•â½¤ä¾‹ var linkedList = new LinkedList() linkedList.append(5) linkedList.append(10) linkedList.append(15) linkedList.append(20) linkedList.log() // '5 10 15 20' linkedList.removeAt(1) linkedList.log() // '5 15 20' linkedList.insert(1, 10) linkedList.log() é›†åˆ Setå’ŒMapnew Set() new WeekSet() new Map() new WeekMap() class Set { constructor() { this.items = {} } has(value) { return this.items.hasOwnProperty(value) } add(value) { if (!this.has(value)) { this.items[value] = value return true } return false } remove(value) { if (this.has(value)) { delete this.items[value] return true } return false } get size() { return Object.keys(this.items).length } get values() { return Object.keys(this.items) } } const set = new Set() set.add(1) console.log(set.values) // [\"1\"] console.log(set.has(1)) // true console.log(set.size) // 1 set.add(2) console.log(set.values) // [\"1\", \"2\"] console.log(set.has(2)) // true console.log(set.size) // 2 set.remove(1) console.log(set.values) // [\"2\"] set.remove(2) console.log(set.values) // [] å“ˆå¸Œè¡¨ åç§° æ•£åˆ—å‡½æ•° æ•£åˆ—å€¼ æ•£åˆ—è¡¨ John 74+111+104+110 399 [399] [john@qq.com] class HashTable { constructor() { this.items = {} } put(key, value) { const hash = this.keyToHash(key) this.items[hash] = value } get(key) { return this.items[this.keyToHash(key)] } remove(key) { delete(this.items[this.keyToHash(key)]) } keyToHash(key) { let hash = 0 for (let i = 0; i &lt; key.length; i++) { hash += key.charCodeAt(i) } hash = hash % 37 // ä¸ºäº†é¿å… hash çš„å€¼è¿‡â¼¤ return hash } } let ht = new HashTable() ht.put('name', 'xxx') ht.put('age', '6') console.log(ht.get('name')) ht.remove('name') console.log(ht.get('name')) ç®—æ³•æŠ€å·§åŠ¨æ€è§„åˆ’// ä¾‹å¦‚æ–æ³¢é‚£å¥‘ // é€’å½’ function fib(n) { if (n == 1 || n == 2) return 1 return fib(n - 1) + fib(n - 2) } // åŠ¨å½’ è§£å†³å­é—®é¢˜é‡å¤ function fib(n) { let memo = [] return helper(memo, n) } function helper(memo, n) { if (n == 1 || n == 2) { // å‰ä¸¤ä¸ª return 1 } // å¦‚æœæœ‰ç¼“å­˜ï¼Œç›´æ¥è¿”å› if (memo[n]) return memo[n]; // æ²¡ç¼“å­˜ memo[n] = helper(memo, n - 1) + helper(memo, n - 2) return memo[n] } // åŠ¨å½’è§£å†³ function fib(n) { let dp = [] dp[1] = dp[2] = 1 for (let i = 3; i &lt;= n; i++) { dp[i] = dp[i - 1] + dp[i - 2]; } return dp[n] } // å‡å¦‚æœ‰1,5,10,20,50,100äººæ°‘å¸ 4 [1, 1, 1, 1] // éœ€ 4 ä¸ª 1 5 [5] // éœ€ 1 ä¸ª 5 36 [20, 10, 5, 1] // éœ€ 20ã€10ã€5ã€1å„â¼€ä¸ª class Change { constructor(changeType) { this.changeType = changeType this.cache = {} } makeChange(amount) { let min = [] if (!amount) { return [] } if (this.cache[amount]) { // è¯»ç¼“å­˜ return this.cache[amount] } for (let i = 0; i &lt; this.changeType.length; i++) { const leftAmount = amount - this.changeType[i] let newMin if (leftAmount &gt;= 0) { newMin = this.makeChange(leftAmount) // è¿™â¼€å¥æ˜¯åŠ¨æ€è§„åˆ’çš„æç° } if (leftAmount &gt;= 0 &amp;&amp; (newMin.length &lt; min.length - 1 || !min.length)) { // å¦‚æœå­˜åœ¨æ›´â¼©çš„æ‰¾é›¶ç¡¬å¸æ•°, åˆ™æ‰§â¾åâ¾¯è¯­å¥ min = [this.changeType[i]].concat(newMin) } } return this.cache[amount] = min } } const change = new Change([1, 5, 10, 20, 50, 100]) console.log(change.makeChange(2)) console.log(change.makeChange(5)) console.log(change.makeChange(13)) console.log(change.makeChange(35)) console.log(change.makeChange(135)) è´ªå¿ƒç®—æ³• // è´ªâ¼¼ å…ˆæ‰¾æœ€å¤§é¢å€¼ï¼Œè¶…äº†å†æ‰¾å…¶ä»–çš„ class Change { constructor(changeType) { this.changeType = changeType.sort((r1, r2) =&gt; r2 - r1) } makeChange(amount) { const arr = [] for (let i = 0; i &lt; this.changeType.length; i++) { while (amount - this.changeType[i] &gt;= 0) { arr.push(this.changeType[i]) amount = amount - this.changeType[i] } } return arr } } const change = new Change([1, 5, 10, 20, 50, 100]) console.log(change.makeChange(36)) console.log(change.makeChange(136)) console.log('-'.repeat(100)) // æœ‰æ—¶è´ªå¿ƒç®—æ³•ä¸ä¸€å®šå‡†ç¡®ï¼Œæ±‚çš„æœ€å¤§è¿‘ä¼¼è§£ const change1 = new Change([1, 3, 4]) console.log(change1.makeChange(6)) // å…¶å®[3, 3]æœ€å¥½","categories":[],"tags":[{"name":"Javascript","slug":"Javascript","permalink":"https://promisefine.github.io/tags/Javascript/"}],"author":"Doney"},{"title":"å‰ç«¯æ€§èƒ½ä¼˜åŒ–","slug":"optimization","date":"2019-11-16T00:10:03.000Z","updated":"2021-07-16T00:22:26.797Z","comments":true,"path":"posts/604c45ad.html","link":"","permalink":"https://promisefine.github.io/posts/604c45ad.html","excerpt":"","text":"å‰ç«¯æ€§èƒ½ä¼˜åŒ–ï¼šä»è¾“å…¥URLåˆ°é¡µé¢åŠ è½½å®Œæˆï¼Œå‘ç”Ÿäº†ä»€ä¹ˆ 1. â½¤æˆ·è¾“â¼Šwww.baidu.com 2. æµè§ˆå™¨é€šè¿‡DNSï¼ŒæŠŠurlè§£æä¸ºIP 3. å’ŒIPåœ°å€å»ºâ½´TCPé“¾æ¥ å‘é€HTTPè¯·æ±‚ 4. æœåŠ¡å™¨æ¥æ”¶è¯·æ±‚ï¼ŒæŸ¥åº“ï¼Œè¯»â½‚ä»¶ç­‰ï¼Œæ‹¼æ¥å¥½è¿”å›çš„HTTPå“åº” 5. æµè§ˆå™¨æ”¶åˆ°â¾¸å±htmlï¼Œå¼€å§‹æ¸²æŸ“ 6. è§£æhtmlä¸ºdom 7. è§£æcss ä¸ºcss-tree 8. dom+ css â½£æˆrender-tree ç»˜å›¾ 9. åŠ è½½scriptçš„jsâ½‚ä»¶ 10. æ‰§â¾js // DNS ä¼˜åŒ– &lt;link rel=\"dns-prefetch\" href=\"dnsçš„åœ°å€\"/&gt; // IP TCP HTTPçš„å…³ç³» 1ã€IPè´Ÿè´£æ‰¾åˆ°èµ„æº 2ã€TCPè´Ÿè´£æ•°æ®çš„å®Œæ•´æ€§å’Œæœ‰åºæ€§ï¼Œä¸‰æ¬¡æ¡æ‰‹å››æ¬¡æŒ¥æ‰‹ 3ã€httpåº”ç”¨å±‚ï¼Œè´Ÿè´£åº”ç”¨å±‚æ•°æ® // ä¼˜åŒ– 1. â»“è¿æ¥ 2. å‡å°‘â½‚ä»¶ä½“ç§¯ 1. jsæ‰“åŒ…å‹ç¼© 2. å›¾â½šå‹ç¼© 3. gzip 3. å‡å°‘â½‚ä»¶è¯·æ±‚æ¬¡æ•° 1. é›ªç¢§å›¾ 2. jsï¼Œcssæ‰“åŒ… 3. ç¼“å­˜æ§åˆ¶ 4. æ‡’åŠ è½½ 4. å‡å°‘â½¤æˆ·å’ŒæœåŠ¡å™¨çš„è·ç¦» 1. cdn 5. æœ¬åœ°å­˜å‚¨ 6. httpä¼˜åŒ– å°†éªŒè¯æ”¾åœ¨headerä¸­ // é€šè¿‡â½¹ç»œè·å–å†…å®¹æ—¢é€Ÿåº¦ç¼“æ…¢â¼œå¼€é”€å·¨â¼¤ã€‚è¾ƒâ¼¤çš„å“åº”éœ€è¦åœ¨å®¢æˆ·ç«¯ä¸æœåŠ¡å™¨ä¹‹é—´è¿›â¾å¤šæ¬¡å¾€è¿”é€šä¿¡ï¼Œ // è¿™ä¼šå»¶è¿Ÿæµè§ˆå™¨è·å¾—å’Œå¤„ç†å†…å®¹çš„æ—¶é—´ï¼Œè¿˜ä¼šå¢åŠ è®¿é—®è€…çš„æµé‡è´¹â½¤ã€‚å› æ­¤ï¼Œç¼“å­˜å¹¶é‡å¤åˆ©â½¤ä¹‹å‰è·å– // çš„èµ„æºçš„èƒ½â¼’æˆä¸ºæ€§èƒ½ä¼˜åŒ–çš„â¼€ä¸ªå…³é”®â½…â¾¯ã€‚ 7ã€æµè§ˆå™¨ç¼“å­˜ 1. Http Cache 2. Service Worker Cache ç‹¬ç«‹äºä¸»çº¿ç¨‹ä¹‹å¤–çš„js,å®ç°ç¦»çº¿ç¼“å­˜å’Œç½‘ç»œä»£ç† window.navigator.serviceWorker.register('/xxx.js').then( function () { console.log('æ³¨å†ŒæˆåŠŸ') }).catch(err =&gt; { console.error(\"æ³¨å†Œå¤±è´¥\") }) 3. Memory Cache 4. Push Cache // headerä¸­è®¾ç½® å¼ºç¼“å­˜ expires: Wed, 11 Mar 2019 16:12:18 GMT cache-control: max-age=31536000 // 1.1 ç²¾å‡† ä¼˜å…ˆçº§â¾¼ // åå•†ç¼“å­˜ 304 not Modified 1ã€ç¬¬ä¸€ç§æ–¹å¼ If-Modified-Since: Fri, 27 Oct 2017 06:35:57 GMT 2ã€ç¬¬äºŒç§æ–¹å¼ ETag: W/\"2aaa-129892f459\" // ç±»ä¼¼æ–‡ä»¶çš„æŒ‡çº¹ If-None-Match: W/\"2aaa-129892f459\" æ–‡ä»¶æ‰“åŒ… webpackå›¾ç‰‡ä¼˜åŒ–// performance performance.getEntriesByType('navigation') // lighthouse npm install -g lighthouse lighthouse https://www.kaikeba.com/ --view // ä»¥ä¸Šä¸¤ä¸ªç”¨äºæ€§èƒ½ç›‘æ§ å›¾â½šé€šå¸¸æ˜¯æœ€å â½¤æµé‡çš„ï¼ŒPCç«¯åŠ è½½çš„å¹³å‡å›¾â½šâ¼¤â¼©æ—¶600K. ä¸åŒçš„åœºæ™¯ï¼Œä½¿â½¤ä¸åŒçš„â½‚ä»¶â¾¥ç±»å‹ 1. jpg 1. æœ‰æŸå‹ç¼© 2. ä½“ç§¯â¼© ä¸â½€æŒé€æ˜ 3. â½¤äºèƒŒæ™¯å›¾ï¼Œè½®æ’­å›¾ 2. png 1. â½†æŸå‹ç¼©ï¼Œè´¨é‡â¾¼ï¼Œâ½€æŒé€æ˜ 2. â¾Šå½©çº¿æ¡æ›´ä¸°å¯Œï¼Œâ¼©å›¾ï¼Œâ½å¦‚logoï¼Œå•†å“icon 3. svg 1. â½‚æœ¬ï¼Œä½“ç§¯â¼© â½®é‡å›¾ 2. æ¸²æŸ“æˆæœ¬ï¼Œå­¦ä¹ æˆæœ¬ gzip accept-encoding:gzip å¼€å¯gzipHTTP å‹ç¼©å°±æ˜¯ä»¥ç¼©â¼©ä½“ç§¯ä¸ºâ½¬çš„ï¼Œå¯¹ HTTP å†…å®¹è¿›â¾é‡æ–°ç¼–ç çš„è¿‡ç¨‹ Gzip å‹ç¼©èƒŒåçš„åŸç†ï¼Œæ˜¯åœ¨â¼€ä¸ªâ½‚æœ¬â½‚ä»¶ä¸­æ‰¾å‡ºâ¼€äº›é‡å¤å‡ºç°çš„å­—ç¬¦ä¸²ã€ä¸´æ—¶æ›¿æ¢å®ƒä»¬ï¼Œä»â½½ä½¿æ•´ä¸ªâ½‚ ä»¶å˜â¼©ã€‚æ ¹æ®è¿™ä¸ªåŸç†ï¼Œâ½‚ä»¶ä¸­ä»£ç çš„é‡å¤ç‡è¶Šâ¾¼ï¼Œé‚£ä¹ˆå‹ç¼©çš„æ•ˆç‡å°±è¶Šâ¾¼ï¼Œä½¿â½¤ Gzip çš„æ”¶ç›Šä¹Ÿå°±è¶Š â¼¤ã€‚ åŸºæœ¬ä¸Šæ¥è¯´ï¼ŒGzipéƒ½æ˜¯æœåŠ¡å™¨â¼²çš„æ´»ï¼Œâ½å¦‚nginx æœåŠ¡å™¨ç«¯æ¸²æŸ“ Reactçš„Nextjs Vueçš„NuxtjsReactçš„é•¿åˆ—è¡¨åŠ è½½ React-virtualizedimport { List } from \"react-virtualized\"; &lt;div className=\"list\"&gt; &lt;List width={rowWidth} height={listHeight} rowHeight={rowHeight} rowRenderer={this.renderRow.bind(this)} rowCount={this.list.length} /&gt; &lt;/div&gt; renderRow({ index, key, style }) { return ( &lt;div key={key} style={style} className=\"row\"&gt; &lt;div className=\"image\"&gt; &lt;img src={this.list[index].image} alt=\"\" /&gt; &lt;/div&gt; &lt;div className=\"content\"&gt; &lt;div&gt;{this.list[index].name}&lt;/div&gt; &lt;div&gt;{this.list[index].text}&lt;/div&gt; &lt;/div&gt; &lt;/div&gt; ); } ç™½å±åº”å¯¹â»£æ¶ï¼Œâ¾ƒåŠ¨åŒ–â½…æ¡ˆï¼Œpage-skeleton-webpack-plugin, ä»¥åŠantdçš„skeletonç»„ä»¶ ç§»åŠ¨ç«¯ç‚¹å‡»äº‹ä»¶300sçš„å»¶è¿Ÿå’Œç‚¹å‡»ç©¿é€// ç§»åŠ¨ç«¯æµè§ˆå™¨ä¼šæœ‰ä¸€äº›é»˜è®¤çš„è¡Œä¸ºï¼Œæ¯”å¦‚åŒå‡»ç¼©æ”¾ã€åŒå‡»æ»šåŠ¨ã€‚è¿™äº›è¡Œä¸ºï¼Œå°¤å…¶æ˜¯åŒå‡»ç¼©æ”¾ï¼Œä¸»è¦æ˜¯ä¸ºæ¡Œé¢ç½‘ç«™åœ¨ç§»åŠ¨ç«¯çš„æµè§ˆä½“éªŒè®¾è®¡çš„ã€‚è€Œåœ¨ç”¨æˆ·å¯¹é¡µé¢è¿›è¡Œæ“ä½œçš„æ—¶å€™ï¼Œç§»åŠ¨ç«¯æµè§ˆå™¨ä¼šä¼˜å…ˆåˆ¤æ–­ç”¨æˆ·æ˜¯å¦è¦è§¦å‘é»˜è®¤çš„è¡Œä¸ºã€‚ 1ã€æ–¹æ¡ˆä¸€ï¼šç¦ç”¨ç¼©æ”¾ &lt;meta name=\"viewport\" content=\"user-scalable=no\"&gt; &lt;meta name=\"viewport\" content=\"initial-scale=1,maximum-scale=1\"&gt; 2ã€æ–¹æ¡ˆäºŒï¼šæ›´æ”¹é»˜è®¤çš„è§†å£å®½åº¦ &lt;meta name=\"viewport\" content=\"width=device-width\"&gt; æ–¹æ¡ˆä¸€ã€äºŒ Chromeæ”¯æŒ 3ã€CSS touch-action: none IEæ”¯æŒ ä¸»è¦è§£å†³æ–¹æ¡ˆ: // ä½¿ç”¨FastClickåº“ // FastClickçš„å®ç°åŸç†æ˜¯åœ¨æ£€æµ‹åˆ°touchendäº‹ä»¶çš„æ—¶å€™ï¼Œä¼šé€šè¿‡DOMè‡ªå®šä¹‰äº‹ä»¶ç«‹å³å‡ºå‘æ¨¡æ‹Ÿä¸€ä¸ªclickäº‹ä»¶ï¼Œå¹¶æŠŠæµè§ˆå™¨åœ¨300msä¹‹åçš„clickäº‹ä»¶é˜»æ­¢æ‰ã€‚ // ç‚¹å‡»ç©¿é€ è¯´å®Œç§»åŠ¨ç«¯ç‚¹å‡»300mså»¶è¿Ÿçš„é—®é¢˜ï¼Œè¿˜ä¸å¾—ä¸æä¸€ä¸‹ç§»åŠ¨ç«¯ç‚¹å‡»ç©¿é€çš„é—®é¢˜ã€‚å¯èƒ½æœ‰äººä¼šæƒ³ï¼Œæ—¢ç„¶clickç‚¹å‡»æœ‰300msçš„å»¶è¿Ÿï¼Œé‚£å¯¹äºè§¦æ‘¸å±ï¼Œæˆ‘ä»¬ç›´æ¥ç›‘å¬touchstartäº‹ä»¶ä¸å°±å¥½äº†å—ï¼Ÿ ä½¿ç”¨touchstartå»ä»£æ›¿clickäº‹ä»¶æœ‰ä¸¤ä¸ªä¸å¥½çš„åœ°æ–¹ã€‚ ç¬¬ä¸€ï¼štouchstartæ˜¯æ‰‹æŒ‡è§¦æ‘¸å±å¹•å°±è§¦å‘ï¼Œæœ‰æ—¶å€™ç”¨æˆ·åªæ˜¯æƒ³æ»‘åŠ¨å±å¹•ï¼Œå´è§¦å‘äº†touchstartäº‹ä»¶ï¼Œè¿™ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„ç»“æœï¼› ç¬¬äºŒï¼šä½¿ç”¨touchstartäº‹ä»¶åœ¨æŸäº›åœºæ™¯ä¸‹å¯èƒ½ä¼šå‡ºç°ç‚¹å‡»ç©¿é€çš„ç°è±¡ã€‚ // ä»€ä¹ˆæ˜¯ç‚¹å‡»ç©¿é€ï¼Ÿ å‡å¦‚é¡µé¢ä¸Šæœ‰ä¸¤ä¸ªå…ƒç´ Aå’ŒBã€‚Bå…ƒç´ åœ¨Aå…ƒç´ ä¹‹ä¸Šã€‚æˆ‘ä»¬åœ¨Bå…ƒç´ çš„touchstartäº‹ä»¶ä¸Šæ³¨å†Œäº†ä¸€ä¸ªå›è°ƒå‡½æ•°ï¼Œè¯¥å›è°ƒå‡½æ•°çš„ä½œç”¨æ˜¯éšè—Bå…ƒç´ ã€‚æˆ‘ä»¬å‘ç°ï¼Œå½“æˆ‘ä»¬ç‚¹å‡»Bå…ƒç´ ï¼ŒBå…ƒç´ è¢«éšè—äº†ï¼Œéšåï¼ŒAå…ƒç´ è§¦å‘äº†clickäº‹ä»¶ã€‚ è¿™æ˜¯å› ä¸ºåœ¨ç§»åŠ¨ç«¯æµè§ˆå™¨ï¼Œäº‹ä»¶æ‰§è¡Œçš„é¡ºåºæ˜¯touchstart &gt; touchend &gt; clickã€‚è€Œclickäº‹ä»¶æœ‰300msçš„å»¶è¿Ÿï¼Œå½“touchstartäº‹ä»¶æŠŠBå…ƒç´ éšè—ä¹‹åï¼Œéš”äº†300msï¼Œæµè§ˆå™¨è§¦å‘äº†clickäº‹ä»¶ï¼Œä½†æ˜¯æ­¤æ—¶Bå…ƒç´ ä¸è§äº†ï¼Œæ‰€ä»¥è¯¥äº‹ä»¶è¢«æ´¾å‘åˆ°äº†Aå…ƒç´ èº«ä¸Šã€‚å¦‚æœAå…ƒç´ æ˜¯ä¸€ä¸ªé“¾æ¥ï¼Œé‚£æ­¤æ—¶é¡µé¢å°±ä¼šæ„å¤–åœ°è·³è½¬","categories":[],"tags":[{"name":"Web","slug":"Web","permalink":"https://promisefine.github.io/tags/Web/"}],"author":"Doney"},{"title":"Httpçš„ç¼“å­˜æœºåˆ¶","slug":"cache","date":"2019-10-20T00:20:18.000Z","updated":"2021-07-16T00:25:56.901Z","comments":true,"path":"posts/41476be7.html","link":"","permalink":"https://promisefine.github.io/posts/41476be7.html","excerpt":"","text":"Httpçš„ç¼“å­˜æœºåˆ¶function updatetime() { this.timer = this.timer || setInterval(() =&gt; this.time = Date.now(), 5000) return this.time } const http = require('http') http.createServer((req, res) =&gt; { const { url } = req if ('/' === url) { res.end(` &lt;html&gt; &lt;head&gt; &lt;meta charset=\"utf-8\" /&gt; &lt;/head&gt; æ›´æ–°æ—¶é—´ | ${updatetime()} &lt;script src=\"/main.js\"&gt;&lt;/script&gt; &lt;/html&gt; `) } else if (url === '/main.js') { const content = `document.write('&lt;br&gt;main | ${updatetime()}')` // å¼ºç¼“å­˜ expire // res.setHeader('Expires',new Date(Date.now()+10*1000).toGMTString()) // res.setHeader('Cache-Control','max-age=10') res.setHeader('Cache-Control', 'no-cache') // è®¾ç½®è¿‡æœŸæ—¶é—´ // res.setHeader('last-modified',new Date().toGMTString()) // if(new Date(req.headers['if-modified-since']).getTime() + 8*60*3600*1000 + 3 &gt; Date.now()){ // console.log(\"åå•†ç¼“å­˜å‘½ä¸­\"); // res.statusCode = 304 // res.end('') // return // } // å¦ä¸€ç§åå•†ç¼“å­˜ hash const crypto = require('crypto') const hash = crypto.createHash('sha1').update(content).digest('hex') console.log(hash, \"----\"); console.log(req.headers, \"+++++++\"); res.setHeader('Etag', hash) if (req.headers['if-none-match'] === hash) { console.log(\"åå•†ç¼“å­˜å‘½ä¸­\"); res.statusCode = 304 res.end('') return } res.statusCode = 200 res.end(content) } else if (url === '/favicon.ico') { res.end('') } }) .listen(3000, () =&gt; { console.log('æœåŠ¡å™¨è¿è¡Œåœ¨3000ç«¯å£'); }) å¼‚æ­¥è¯»å–æ–‡ä»¶const fs = require('fs') const {promisify} = require('util') const readFile = promisify(fs.readFile) process.nextTick(async () =&gt; { const data = await readFile('./index.html') // console.log(data.toString()); const buf = Buffer.alloc(10) console.log(data); }) æµ nodeåŸºäºæµconst fs = require('fs') const rs = fs.createReadStream('./index.html') const ws = fs.createWriteStream('./home.html') rs.pipe(ws) åˆ¶å®šauto-vue-routernpm i commander download-git-repo ora handlebars figlet clear chalk open -s // bin/yl.js #!/usr/bin/env node const program = require('commander') program.version(require('../package').version) program .command('init &lt;name&gt;') .description('init project') // .action(name =&gt; { // console.log('init ' + name) // }) .action(require('../lib/init')) program .command('refresh') .description('refresh routers...') .action(require('../lib/refresh')) program.parse(process.argv) // lib/init.js // å°†å¼‚æ­¥å˜æˆåŒæ­¥ const { promisify } = require('util') // è¾“å‡ºä¸€äº›ç‰¹æ®Šçš„æ–‡å­— ä¸ºå¼‚æ­¥æ–¹æ³• const figlet = promisify(require('figlet')) const clear = require('clear') // æ”¹å˜å‘½ä»¤è¡Œé£æ ¼ --- é¢œè‰²ç­‰ const chalk = require('chalk') const log = content =&gt; console.log(chalk.green(content)) // cloneå…‹éš† const {clone} = require('./download') // å®‰è£…ä¾èµ– const spawn = async (...args) =&gt; { // å¼€å¯å­è¿›ç¨‹ const { spawn } = require('child_process'); return new Promise(resolve =&gt; { const proc = spawn(...args) // è¾“å‡ºæµ å­è¿›ç¨‹å¯¼å…¥åˆ°ä¸»è¿›ç¨‹ proc.stdout.pipe(process.stdout) // é”™è¯¯æµ proc.stderr.pipe(process.stderr) proc.on('close', () =&gt; { resolve() }) }) } // æ‰“å¼€æµè§ˆå™¨ const open = require(\"open\") module.exports = async name =&gt; { console.log(name, \"|| name\"); // æ‰“å°æ¬¢è¿ç”»â¾¯ clear() const data = await figlet('yl Welcome') log(data); log('ğŸš€åˆ›å»ºé¡¹â½¬:' + name) // å…‹éš†é¡¹ç›® await clone('github:su37josephxia/vue-template', name) // å®‰è£…ä¾èµ– log('å®‰è£…ä¾èµ–'); // cnpm install ./test await spawn('cnpm', ['install'], { cwd: `./${name}` }) log(chalk.green(` To get Start: =========================== cd ${name} npm run serve =========================== `)) // æ‰“å¼€æµè§ˆå™¨ open(`http://localhost:8080`); await spawn('npm', ['run', 'serve'], { cwd: `./${name}` }) } // lib/download.js const { promisify } = require('util') module.exports.clone = async function (repo, desc) { const download = promisify(require('download-git-repo')) const ora = require('ora') const process = ora(`ä¸‹è½½.....${repo}`) process.start() await download(repo, desc) process.succeed() } // lib/refresh.js const fs = require('fs') const handlebars = require('handlebars') const chalk = require('chalk') module.exports = async () =&gt; { // è·å–â»šâ¾¯åˆ—è¡¨ const list = fs.readdirSync('./src/views') .filter(v =&gt; v !== 'Home.vue') .map(v =&gt; ({ name: v.replace('.vue', '').toLowerCase(), file: v })) // â½£æˆè·¯ç”±å®šä¹‰ compile({ list }, './src/router.js', './template/router.js.hbs') // â½£æˆèœå• compile({ list }, './src/App.vue', './template/App.vue.hbs') /** * ç¼–è¯‘æ¨¡æ¿â½‚ä»¶ * @param meta æ•°æ®å®šä¹‰ * @param filePath â½¬æ ‡â½‚ä»¶è·¯å¾„ * @param templatePath æ¨¡æ¿â½‚ä»¶è·¯å¾„ */ function compile(meta, filePath, templatePath) { if (fs.existsSync(templatePath)) { const content = fs.readFileSync(templatePath).toString(); const result = handlebars.compile(content)(meta); fs.writeFileSync(filePath, result); } console.log(chalk.green(`ğŸš€${filePath} åˆ›å»ºæˆåŠŸ`)) } } AOPï¼šAspect Oriented Programming é¢å‘åˆ‡é¢ç¼–ç¨‹æ—¥å¿—è®°å½•ï¼Œæ€§èƒ½ç»Ÿè®¡ï¼Œå®‰å…¨æ§åˆ¶ï¼Œäº‹åŠ¡å¤„ç†ï¼Œå¼‚å¸¸å¤„ç†ç­‰ç­‰ã€‚Koaconst Koa = require('koa') const app = new Koa() app.use(require('koa-static')(__dirname + '../public/')) const router = require('koa-router')() router.get('/string', async (ctx, next) =&gt; { ctx.body = 'koa2 string' }) router.get('/json', async (ctx, next) =&gt; { ctx.body = { title: 'koa2 json' } }) app.use(router.routes()) app.use(async (ctx, next) =&gt; { const start = new Date().getTime() console.log(`start: ${ctx.url}`); await next() const end = new Date().getTime() console.log(`${ctx.url} | è€—æ—¶: ${end - start}ms`); }) app.use((ctx) =&gt; { ctx.body = 'Hello Koa' }) app.listen(3000) ç»„åˆå‡½æ•° composeå‡½æ•°Koaä¸­é—´ä»¶æœºåˆ¶å°±æ˜¯å‡½æ•°å¼ ç»„åˆæ¦‚å¿µ Composeçš„æ¦‚å¿µï¼Œå°†â¼€ç»„éœ€è¦é¡ºåºæ‰§â¾çš„å‡½æ•°å¤åˆä¸ºâ¼€ä¸ªå‡½æ•°ï¼Œå¤–å±‚å‡½æ•°çš„å‚æ•°å®é™…æ˜¯å†…å±‚å‡½æ•°çš„è¿”å›å€¼ã€‚const add = (x, y) =&gt; x + y const square = z =&gt; z * z const fn = (x, y) =&gt; square(add(x, y)) console.log(fn(1, 2)) const compose = (fn1, fn2) =&gt; (...args) =&gt; fn2(fn1(...args)) const fn = compose(add,square) const compose = (...[first, ...other]) =&gt; (...args) =&gt; { let ret = first(...args) other.forEach(fn =&gt; { ret = fn(ret) }) return ret } const fn = compose(add, square) console.log(fn(1, 2)) function compose(middlewares) { return function () { return dispatch(0); // æ‰§â¾ç¬¬0ä¸ª function dispatch(i) { let fn = middlewares[i]; if (!fn) { return Promise.resolve(); } return Promise.resolve( fn(function next() { // promiseå®Œæˆåï¼Œå†æ‰§â¾ä¸‹â¼€ä¸ª return dispatch(i + 1); }) ); } }; } async function fn1(next) { console.log(\"fn1\"); await next(); console.log(\"end fn1\"); } async function fn2(next) { console.log(\"fn2\"); await delay(); await next(); console.log(\"end fn2\"); } function fn4(next) { console.log(\"fn4\"); next() } async function fn3(next) { console.log(\"fn3\"); await delay(); await next(); console.log(\"end fn3\"); } function delay() { return new Promise((reslove) =&gt; { setTimeout(() =&gt; { reslove(); }, 2000); }); } const middlewares = [fn1, fn2, fn4, fn3]; const finalFn = compose(middlewares); finalFn();","categories":[],"tags":[{"name":"Http","slug":"Http","permalink":"https://promisefine.github.io/tags/Http/"}],"author":"Doney"},{"title":"è®¾è®¡æ¨¡å¼","slug":"Design","date":"2019-10-08T06:22:10.000Z","updated":"2021-07-15T11:48:48.707Z","comments":true,"path":"posts/364ea8cc.html","link":"","permalink":"https://promisefine.github.io/posts/364ea8cc.html","excerpt":"","text":"è®¾è®¡æ¨¡å¼ï¼ˆDesign Patternï¼‰æ˜¯â¼€å¥—è¢«åå¤ä½¿â½¤ã€å¤šæ•°â¼ˆçŸ¥æ™“çš„ã€ç»è¿‡åˆ†ç±»çš„ã€ä»£ç è®¾è®¡ç»éªŒçš„æ€»ç»“ã€‚å‘å¸ƒè®¢é˜…æ¨¡å¼class Event { constructor() { this.callbacks = {} } $off(name) { this.callbacks[name] = null } $emit(name, args) { let cbs = this.callbacks[name] if (cbs) { cbs.forEach(c =&gt; { c.call(this, args) }) } } $on(name, fn) { (this.callbacks[name] || (this.callbacks[name] = [])).push(fn) } } let event = new Event() event.$on('event1', function (arg) { console.log('äº‹ä»¶1', arg) }) event.$on('event1', function (arg) { console.log('â¼œâ¼€ä¸ªæ—¶é—´1', arg) }) event.$on('event2', function (arg) { console.log('äº‹ä»¶2', arg) }) event.$emit('event1', { name: '2005A' }) event.$emit('event2', { name: '2006A' }) event.$off('event1') event.$emit('event1', { name: '2007A' }) å•ä¾‹æ¨¡å¼&lt;!DOCTYPE html&gt; &lt;html lang=\"en\"&gt; &lt;head&gt; &lt;meta charset=\"UTF-8\"&gt; &lt;meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\"&gt; &lt;meta http-equiv=\"X-UA-Compatible\" content=\"ie=edge\"&gt; &lt;title&gt;å•ä¾‹æ¨¡å¼&lt;/title&gt; &lt;style&gt; .model { border: 1px solid black; position: fixed; width: 300px; height: 300px; top: 20%; left: 50%; margin-left: -150px; text-align: center; } &lt;/style&gt; &lt;/head&gt; &lt;body&gt; &lt;h1&gt;å¼¹çª—ï¼Œâ½†è®ºç‚¹å‡»å¤šå°‘æ¬¡ï¼Œå¼¹çª—åªåº”è¯¥è¢«åˆ›å»ºâ¼€æ¬¡&lt;/h1&gt; &lt;div id=\"loginBtn\"&gt;ç‚¹æˆ‘&lt;/div&gt; &lt;script&gt; var getSingle = function (fn) { var result; return function () { return result || (result = fn.apply(this, arguments)); } }; var createLoginLayer = function () { var div = document.createElement('div'); div.innerHTML = 'æˆ‘æ˜¯ç™»å½•æµ®çª—'; div.className = 'model' div.style.display = 'none'; document.body.appendChild(div); return div; }; // å•ä¾‹æ¨¡å¼ å¯ä»¥å»æ‰ä¸€ä¸‹è¿™ä¸€è¡Œä»£ç è¯•è¯•é¡µé¢ç‚¹å‡»æƒ…å†µ var createSingleLoginLayer = getSingle(createLoginLayer); document.getElementById('loginBtn').onclick = function () { var loginLayer = createSingleLoginLayer(); loginLayer.style.display = 'block'; }; &lt;/script&gt; &lt;/body&gt; &lt;/html&gt; ç­–ç•¥æ¨¡å¼â¼€ä¸ªåŸºäºç­–ç•¥æ¨¡å¼çš„ç¨‹åºâ¾„å°‘ç”±ä¸¤éƒ¨åˆ†ç»„æˆã€‚ // ç¬¬â¼€ä¸ªéƒ¨åˆ†æ˜¯â¼€ç»„ç­–ç•¥ç±»ï¼ˆå¯å˜ï¼‰ï¼Œç­–ç•¥ç±»å°è£…äº†å…·ä½“çš„ç®—æ³•ï¼Œå¹¶è´Ÿè´£å…·ä½“çš„è®¡ç®—è¿‡ç¨‹ã€‚ // ç¬¬â¼†ä¸ªéƒ¨åˆ†æ˜¯ç¯å¢ƒç±»Contextï¼ˆä¸å˜ï¼‰ï¼ŒContextæ¥å—å®¢æˆ·çš„è¯·æ±‚ï¼Œéšåå°†è¯·æ±‚å§”æ‰˜ç»™æŸâ¼€ä¸ªç­–ç•¥ç±»ã€‚ // ä¾‹å­ï¼š var calc = function (pm, salary) { if (pm === 'S') { return salary * 4; } if (pm === 'A') { return salary * 3; } if (pm === 'B') { return salary * 2; } }; calculateBonus('B', 20000); // è¾“å‡º:40000 calculateBonus('S', 6000); // è¾“å‡º:24000 // ä½¿ç”¨ç­–ç•¥æ¨¡å¼ var strategies = { \"S\": function (salary) { return salary * 4; }, \"A\": function (salary) { return salary * 3; }, \"B\": function (salary) { return salary * 2; } }; var calculateBonus = function (level, salary) { return strategies[level](salary); }; console.log(calculateBonus('S', 20000)); // è¾“å‡º:80000 console.log(calculateBonus('A', 10000)); // è¾“å‡º:30000 // è¡¨å•æ ¡éªŒ var registerForm = document.getElementById('registerForm'); registerForm.onsubmit = function () { if (registerForm.userName.value === '') { alert('â½¤æˆ·åä¸èƒ½ä¸ºç©º'); return false; } if (registerForm.password.value.length &lt; 6) { alert('å¯†ç â»“åº¦ä¸èƒ½å°‘äº 6 ä½'); return false; } if (!/(^1[3|5|8][0-9]{9}$)/.test(registerForm.phoneNumber.value)) { alert('â¼¿æœºå·ç æ ¼å¼ä¸æ­£ç¡®'); return false; } } // ä½¿ç”¨ç­–ç•¥æ¨¡å¼ var strategies = { isNonEmpty: function (value, errorMsg) { if (value === '') { return errorMsg; } }, minLength: function (value, length, errorMsg) { if (value.length &lt; length) { return errorMsg; } }, isMobile: function (value, errorMsg) { // â¼¿æœºå·ç æ ¼å¼ if (!/(^1[3|5|8][0-9]{9}$)/.test(value)) { return errorMsg; } } }; var Validator = function () { this.cache = []; // ä¿å­˜æ ¡éªŒè§„åˆ™ }; Validator.prototype.add = function (){ var ary = rule.split(':'); this.cache.push(function () { // var strategy = ary.shift(); ary.unshift(dom.value); ary.push(errorMsg); return strategies[strategy].apply(dom, ary); }); }; Validator.prototype.start = function () { for (var i = 0, validatorFunc; validatorFunc = this.cache[i++];) { var msg = validatorFunc(); // å¼€å§‹æ ¡éªŒï¼Œå¹¶å–å¾—æ ¡éªŒåçš„è¿”å›ä¿¡æ¯ if (msg) { // å¦‚æœæœ‰ç¡®åˆ‡çš„è¿”å›å€¼ï¼Œè¯´æ˜æ ¡éªŒæ²¡æœ‰é€šè¿‡ return msg; } } }; var validataFunc = function () { var validator = new Validator(); // åˆ›å»ºâ¼€ä¸ª validator å¯¹è±¡ /***************æ·»åŠ â¼€äº›æ ¡éªŒè§„åˆ™****************/ validator.add(registerForm.userName, 'isNonEmpty', 'â½¤æˆ·åä¸èƒ½ä¸ºç©º'); validator.add(registerForm.password, 'minLength:6', 'å¯†ç â»“åº¦ä¸èƒ½å°‘äº 6ä½'); validator.add(registerForm.phoneNumber, 'isMobile', 'â¼¿æœºå·ç æ ¼å¼ä¸æ­£ç¡®'); var errorMsg = validator.start(); // è·å¾—æ ¡éªŒç»“æœ return errorMsg; // è¿”å›æ ¡éªŒç»“æœ } var registerForm = document.getElementById('registerForm'); registerForm.onsubmit = function () { var errorMsg = validataFunc(); // å¦‚æœ errorMsg æœ‰ç¡®åˆ‡çš„è¿”å›å€¼ï¼Œè¯´æ˜æœªé€šè¿‡æ ¡éªŒ if (errorMsg) { alert(errorMsg); return false; // é˜»â½Œè¡¨å•æäº¤ } }; ä»£ç†æ¨¡å¼&lt;!DOCTYPE html&gt; &lt;html lang=\"en\"&gt; &lt;head&gt; &lt;meta charset=\"UTF-8\"&gt; &lt;meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\"&gt; &lt;meta http-equiv=\"X-UA-Compatible\" content=\"ie=edge\"&gt; &lt;title&gt;Document&lt;/title&gt; &lt;style&gt; .model { border: 1px solid black; position: fixed; width: 300px; height: 300px; top: 20%; left: 50%; margin-left: -150px; text-align: center; } &lt;/style&gt; &lt;/head&gt; &lt;body&gt; &lt;input type=\"checkbox\" id=\"1\"&gt; &lt;input type=\"checkbox\" id=\"2\"&gt; &lt;input type=\"checkbox\" id=\"3\"&gt; &lt;script&gt; var synchronousFile = function (id) { console.log('å¼€å§‹åŒæ­¥â½‚ä»¶ï¼Œid ä¸º: ' + id); }; var proxySynchronousFile = (function () { var cache = [], // ä¿å­˜â¼€æ®µæ—¶é—´å†…éœ€è¦åŒæ­¥çš„ ID timer; // å®šæ—¶å™¨ return function (id) { cache.push(id); if (timer) { // ä¿è¯ä¸ä¼šè¦†ç›–å·²ç»å¯åŠ¨çš„å®šæ—¶å™¨ return; } timer = setTimeout(function () { synchronousFile(cache.join(',')); clearTimeout(timer); // æ¸…ç©ºå®šæ—¶å™¨ timer = null; cache.length = 0; // æ¸…ç©º ID é›†åˆ }, 2000); } // 2 ç§’åå‘æœ¬ä½“å‘é€éœ€è¦åŒæ­¥çš„ ID é›†åˆ })(); var checkbox = document.getElementsByTagName('input'); for (var i = 0, c; c = checkbox[i++];) { c.onclick = function () { if (this.checked === true) { proxySynchronousFile(this.id); } } }; &lt;/script&gt; &lt;/body&gt; &lt;/html&gt; å·¥å‚æ¨¡å¼è£…é¥°å™¨æ¨¡å¼äº«å…ƒæ¨¡å¼(ä¼˜åŒ–æ¨¡å¼ï¼Œå¸¸ç”¨åœ¨å°è£…å¼¹æ¡†ç»„ä»¶)export default { install(Vue) { // åœ¨ä½¿â½¤æ’ä»¶Vue.use(Message)æ—¶å®ä¾‹åŒ–â¼€ä¸ªDialogç»„ä»¶å¯¹è±¡ const Dialog = new Vue({ data() { return { icon: '', fontStyle: '', backgroundStyle: '', text: '' } } ... }) // æ‰©å±•Vueçš„`prototype` Vue.prototype.$Message = { success(text) { // æ”¹å˜Dialogçš„data.xxçš„å€¼è§¦å‘Dialogçš„æ›´æ–° Dialog.icon = successIcon Dialog.fontStyle = successFontStyle Dialog.backgroundStyle = successBackgroundStyle Dialog.text = text // è·å–Dialogçš„æœ€æ–°DOMæ·»åŠ åˆ°bodyæ ‡ç­¾ä¸­ document.body.appendChild(Dialog.$el) }, warning(text) { // åŒä¸Š ... document.body.appendChild(Dialog.$el) }, error(text) { // åŒä¸Š ... document.body.appendChild(Dialog.$el) } } } }","categories":[],"tags":[{"name":"Javascript","slug":"Javascript","permalink":"https://promisefine.github.io/tags/Javascript/"}]},{"title":"Promiseå¹¶å‘","slug":"Concurrent","date":"2019-09-24T00:38:23.000Z","updated":"2021-07-16T00:39:59.211Z","comments":true,"path":"posts/9123c35c.html","link":"","permalink":"https://promisefine.github.io/posts/9123c35c.html","excerpt":"","text":"ä»£ç æ¼”ç¤ºvar urls = [ \"https://hexo-blog-1256114407.cos.ap-shenzhen-fsi.myqcloud.com/AboutMe-painting1.png\", \"https://hexo-blog-1256114407.cos.ap-shenzhen-fsi.myqcloud.com/AboutMe-painting2.png\", \"https://hexo-blog-1256114407.cos.ap-shenzhen-fsi.myqcloud.com/AboutMe-painting3.png\", \"https://hexo-blog-1256114407.cos.ap-shenzhen-fsi.myqcloud.com/AboutMe-painting4.png\", \"https://hexo-blog-1256114407.cos.ap-shenzhen-fsi.myqcloud.com/AboutMe-painting5.png\", \"https://hexo-blog-1256114407.cos.ap-shenzhen-fsi.myqcloud.com/bpmn6.png\", \"https://hexo-blog-1256114407.cos.ap-shenzhen-fsi.myqcloud.com/bpmn7.png\", \"https://hexo-blog-1256114407.cos.ap-shenzhen-fsi.myqcloud.com/bpmn8.png\", ]; function loadImg(url) { return new Promise((resolve, reject) =&gt; { const img = new Image(); img.onload = function() { console.log(\"ä¸€å¼ å›¾ç‰‡åŠ è½½å®Œæˆ\"); resolve(img); }; img.onerror = function() { reject(new Error('åœ°å€åŠ è½½å¤±è´¥:' + url)); }; img.src = url; }); }; function limitImageLoad(urls, handler, limit) { let sequence = [].concat(urls); // å¤åˆ¶urls // è¿™ä¸€æ­¥æ˜¯ä¸ºäº†åˆå§‹åŒ– promises è¿™ä¸ª\"å®¹å™¨\" let promises = sequence.splice(0, limit).map((url, index) =&gt; { return handler(url).then(() =&gt; { // è¿”å›ä¸‹æ ‡æ˜¯ä¸ºäº†çŸ¥é“æ•°ç»„ä¸­æ˜¯å“ªä¸€é¡¹æœ€å…ˆå®Œæˆ return index; }); }); // æ³¨æ„è¿™é‡Œè¦å°†æ•´ä¸ªå˜é‡è¿‡ç¨‹è¿”å›ï¼Œè¿™æ ·å¾—åˆ°çš„å°±æ˜¯ä¸€ä¸ªPromiseï¼Œå¯ä»¥åœ¨å¤–é¢é“¾å¼è°ƒç”¨ return sequence .reduce((pCollect, url) =&gt; { return pCollect .then(() =&gt; { return Promise.race(promises); // è¿”å›å·²ç»å®Œæˆçš„ä¸‹æ ‡ }) .then((fastestIndex) =&gt; { // è·å–åˆ°å·²ç»å®Œæˆçš„ä¸‹æ ‡ // å°†\"å®¹å™¨\"å†…å·²ç»å®Œæˆçš„é‚£ä¸€é¡¹æ›¿æ¢ promises[fastestIndex] = handler(url).then(() =&gt; { return fastestIndex; // è¦ç»§ç»­å°†è¿™ä¸ªä¸‹æ ‡è¿”å›ï¼Œä»¥ä¾¿ä¸‹ä¸€æ¬¡å˜é‡ }); }) .catch((err) =&gt; { console.error(err); }); }, Promise.resolve()) // åˆå§‹åŒ–ä¼ å…¥ .then(() =&gt; { // æœ€åä¸‰ä¸ªç”¨.allæ¥è°ƒç”¨ return Promise.all(promises); }); } // ä»£ç è°ƒç”¨ limitImageLoad(urls, loadImg, 3) .then((res) =&gt; { console.log(\"å›¾ç‰‡å…¨éƒ¨åŠ è½½å®Œæ¯•\"); console.log(res); }) .catch((err) =&gt; { console.error(err); });","categories":[],"tags":[{"name":"Javascript","slug":"Javascript","permalink":"https://promisefine.github.io/tags/Javascript/"}],"author":"Doney"},{"title":"Promise","slug":"Promise","date":"2019-09-23T02:00:43.000Z","updated":"2021-07-15T11:49:00.170Z","comments":true,"path":"posts/23a0e66.html","link":"","permalink":"https://promisefine.github.io/posts/23a0e66.html","excerpt":"","text":"ä»£ç æ¼”ç¤ºclass myPromise { // å‡†å¤‡çŠ¶æ€ static PENDING = 'pending' // å®ŒæˆçŠ¶æ€ static FULFILLED = 'fulfilled' // å¤±è´¥çŠ¶æ€ static REJECTED = 'rejected' constructor(executor) { this.status = myPromise.PENDING this.value = null this.callbacks = [] try { executor(this.resolve.bind(this), this.reject.bind(this)) } catch (error) { this.reject(error) } } // ç±»æ–¹æ³• // æˆåŠŸ resolve(value) { // console.log(this) // æ”¹å˜promiseçš„çŠ¶æ€ è§£å†³çŠ¶æ€ if (this.status = myPromise.PENDING) { this.status = myPromise.FULFILLED this.value = value } // å˜ä¸ºå¼‚æ­¥ä»»åŠ¡ setTimeout(() =&gt; { this.callbacks.map(callback =&gt; { callback.onFulfilled(value) }) }); } // å¤±è´¥ reject(reason) { if (this.status = myPromise.PENDING) { this.status = myPromise.REJECTED this.value = reason } // å˜ä¸ºå¼‚æ­¥ä»»åŠ¡ setTimeout(() =&gt; { this.callbacks.map(callback =&gt; { callback.onRejected(reason) }) }); } // then then(onFulfilled, onRejected) { if (typeof onFulfilled != 'function') { onFulfilled = () =&gt; { } } if (typeof onRejected != 'function') { onRejected = () =&gt; { } } // å½“çŠ¶æ€ä¸ºå‡†å¤‡çŠ¶æ€ if (this.status == myPromise.PENDING) { this.callbacks.push({ onFulfilled: value =&gt; { try { onFulfilled(value) } catch (error) { onRejected(error) } }, onRejected: value =&gt; { try { onRejected(value) } catch (error) { onRejected(error) } } }) } // å½“çŠ¶æ€ä¸ºå®Œæˆçš„æ—¶å€™æ‰§è¡Œ if (this.status == myPromise.FULFILLED) { // æ”¾åˆ°é˜Ÿåˆ—ã€‚è½®è¯¢æ‰§è¡Œ setTimeout(() =&gt; { // å¤„ç†é”™è¯¯ try { onFulfilled(this.value) } catch (error) { onRejected(error) } }) } // å½“çŠ¶æ€ä¸ºå¤±è´¥çš„æ—¶å€™æ‰§è¡Œ if (this.status == myPromise.REJECTED) { // æ”¾åˆ°é˜Ÿåˆ—ã€‚è½®è¯¢æ‰§è¡Œ setTimeout(() =&gt; { // å¤„ç†é”™è¯¯ try { onRejected(this.value) } catch (error) { onRejected(error) } }) } } }","categories":[],"tags":[{"name":"Javascript","slug":"Javascript","permalink":"https://promisefine.github.io/tags/Javascript/"}],"author":"Doney"},{"title":"debounce","slug":"debounce","date":"2019-09-21T02:24:47.000Z","updated":"2021-07-15T11:48:20.247Z","comments":true,"path":"posts/dbf34790.html","link":"","permalink":"https://promisefine.github.io/posts/dbf34790.html","excerpt":"","text":"ä»£ç æ¼”ç¤ºconst button = document.querySelector('button') function patMoney() { console.log('å·²å‰') } // åˆ›å»ºä¸€ä¸ªé˜²æŠ–å‡½æ•° function debounce(func, delay) { // é˜²æ­¢åœ¨å®šä¹‰ç›‘å¬å‡½æ•°çš„æ—¶å€™å°±ç›´æ¥æ‰§è¡Œäº†å‡½æ•° æ‰€ä»¥æˆ‘ä»¬ç”¨åˆ°é«˜é˜¶å‡½æ•° let timer // é—­åŒ… å› ä¸ºä½œç”¨åŸŸé“¾çš„å…³ç³» æ‰€æœ‰ç‹¬ç«‹çš„æ‰§è¡Œå‡½æ•°éƒ½èƒ½è®¿é—®åˆ°è¿™ä¸ªtimerå˜é‡ return function () { let context = this let args = arguments clearTimeout(timer) // è®¾ç½®setTimeout timer = setTimeout(function () { func.apply(context, args) }, delay) } } button.addEventListener('click', debounce(patMoney, 3000))","categories":[],"tags":[{"name":"Javascript","slug":"Javascript","permalink":"https://promisefine.github.io/tags/Javascript/"}],"author":"Doney"},{"title":"throttle","slug":"throttle","date":"2019-09-20T03:45:23.000Z","updated":"2021-07-15T11:48:12.739Z","comments":true,"path":"posts/ebdc48ec.html","link":"","permalink":"https://promisefine.github.io/posts/ebdc48ec.html","excerpt":"","text":"ä»£ç æ¼”ç¤ºfunction coloring() { let r = Math.floor(Math.random() * 255) let g = Math.floor(Math.random() * 255) let b = Math.floor(Math.random() * 255) document.body.style.background = `rgb(${r},${g},${b})` } function throttle(func, delay) { let pre = 0 return function () { let now = new Date() let context = this let args = arguments if (now - pre &gt; delay) { func.apply(context, args) pre = now } } } window.addEventListener('resize', throttle(coloring, 2000))","categories":[],"tags":[{"name":"Javascript","slug":"Javascript","permalink":"https://promisefine.github.io/tags/Javascript/"}],"author":"Doney"},{"title":"çƒ­è¡€å‘è¨€","slug":"introduce","date":"2019-09-18T02:13:01.000Z","updated":"2021-07-15T11:46:05.400Z","comments":true,"path":"posts/3714eea.html","link":"","permalink":"https://promisefine.github.io/posts/3714eea.html","excerpt":"","text":"çƒ­çˆ±äº’è”ç½‘çƒ­çˆ±å‰ç«¯çƒ­çˆ±æ•²ä»£ç ä¸€åŒ…çƒŸä¸€æ¯èŒ¶ä¸€ä¸ªBugæ”¹ä¸€å¤©æˆ‘ç§ƒäº†ä½†æˆ‘å˜å¼ºäº†ï¼","categories":[],"tags":[{"name":"introduce","slug":"introduce","permalink":"https://promisefine.github.io/tags/introduce/"}]}],"categories":[],"tags":[{"name":"Javascript","slug":"Javascript","permalink":"https://promisefine.github.io/tags/Javascript/"},{"name":"Web","slug":"Web","permalink":"https://promisefine.github.io/tags/Web/"},{"name":"Http","slug":"Http","permalink":"https://promisefine.github.io/tags/Http/"},{"name":"introduce","slug":"introduce","permalink":"https://promisefine.github.io/tags/introduce/"}]}